[{"title":"相由新声","url":"/2024/12/02/相由新声/","content":"\n## 前言\n\n之前看到了Jesse Berezovsky的工作[^1]就想出一道题，奈何一些计算如果只用计算器还是不太够只能放弃了。但是这个问题还是很有意思的，所以就写一下。\n\n音乐具有复杂的旋律，但是又追求协和的声乐效果。联想到一些特殊的热学量，我们可以用内能$U$来表示“不协和程度”，熵$S$表示“复杂度”，那么一个“音乐系统”的自由能就是$F=U-TS$，而最自然的系统应当最小化自由能。\n\n简化起见，我们假定乐器的声音是锯齿波，频率为$f$的锯齿波$y(t)=fAt\\ (0≤ft≤0.5)$的傅里叶级数如下\n\n$$\n\\begin{align}\n  y(t) = \\frac{A}{2} - \\frac{A}{\\pi}\\sum_{j=1}^\\infty\\frac{\\sin2\\pi fjt}{j}\n\\end{align}\n$$\n\n## 相互作用能与音律\n### 热力学系统\n内能既然代表不协和程度，而不协和一定是对多个音调之间关系的描述，也即所谓的“相互作用能”。我们首先只考虑两个音调的情况，即$f_a$和$f_b$。根据上面的傅里叶级数，在频域上对应着$\\{f_a,2f_a,\\cdots,nf_a,f_b,2f_b,\\cdots,nf_b\\}$几个频率，我们将之视作一个有$2n$个粒子的一维热力学系统。\n\n<center>\n<img src=\"/images/20241202/Fig1.png\" width=\"75%\" />\n图1: 两个音调对应的热力学系统\n</center>\n\n在这里为了后续的计算方便对频率进行了截断处理，但是这并不影响结论的正确性。而且人耳受到高频影响较小，所以这个截断是合理的。\n\n### 两个频率的不和谐度\n\nBernini和Talamucci[^2]通过声学实验为我们定量化了人耳对两个频率的不和谐度的感知。因此我们基于其实验结论可以得到计算两个频率$f_a,f_b\\ (f_a<f_b)$的不和谐度的经验公式，即相互作用能\n\n$$\n\\begin{align}\n  u_{ab}=\\begin{cases}\n    \\frac{6.1\\Delta}{\\delta}e^{1-\\frac{6.1\\Delta}{\\delta}}, & f_b\\leq1.2f_a \\\\\n    0, & f_b>1.2f_a\n  \\end{cases}\n\\end{align}\n$$\n\n其中$\\Delta=f_b-f_a$为频率差，$\\delta$则被称作临界带宽（critical bandwidth），其计算经验公式如下\n\n$$\n\\begin{align}\n  \\delta=1.065\\times10^{-5}\\bar{f}^2+0.1145\\bar{f}+50.3559\\ (\\text{Hz})\n\\end{align}\n$$\n\n❗请注意上述公式由笔者为方便计算而简化的拟合公式得到，因此计算结果也与原文有些许不同，准确的实验结果以及经验公式请参考原文[^2]。\n\n### 相互作用能与音律的来源\n\n我们可以将两个频率的相互作用能视作一个“键”（bond），而系统的内能就是所有键的总和。这样我们就可以得到系统的相互作用能为\n\n$$\n\\begin{align}\n  U_{ab}=\\sum_{i=1}^{n}\\sum_{j=i+1}^{n}u_{ij}\n\\end{align}\n$$\n\n以中央C音$f_C=261.626\\ \\text{Hz}$为基准作为例子，我们计算一个八度内其他音调与中央C音的不和谐度。计算代码如下\n\n```python\nimport numpy as np\nimport matplotlib.pyplot as plt\n\n# 临界宽带\ndef critical_bandwidth(freq):\n    delta = 1.065e-5 * freq**2 + 0.1145 * freq + 50.3559\n    return delta\n\n# 两频率间的不和谐度\ndef dissonance(f1, f2):\n    fmin = min(f1, f2)\n    fmax = max(f1, f2)\n    if fmax > 1.2 * fmin:\n        return 0\n    delta_f = fmax - fmin\n    delta = critical_bandwidth((f1 + f2) / 2)\n    tmp = 6.1 * delta_f / delta\n    return tmp * np.exp(1 - tmp)\n\n# 两音调总不和谐度\ndef dissonance_total(f1, f2, n):\n    dissonance_sum = 0\n    for i in range(1, n):\n        for j in range(1, n):\n            dissonance_sum += dissonance(f1 * i, f2 * j)\n    return dissonance_sum\n\n# 绘制不和谐度图\ndef plot_dissonance(f, n):\n    x = np.linspace(1, 2, 5000)\n    y = np.zeros(5000)\n    for i in range(5000):\n        y[i] = dissonance_total(f, f * x[i], n)\n    plt.plot(x, y)\n    plt.xlabel('Frequency Ratio')\n    plt.ylabel('Dissonance')\n    plt.title('Dissonance of Two Tones')\n    plt.show()\n\n# 主函数\nif __name__ == '__main__':\n    f = 261.626\n    n = 8\n    plot_dissonance(f, n)\n```\n\n计算结果如下图所示，可以发现其中存在一些极小值点，而计算这些点的位置我们会发现这些点正好对应着$1:1$,$1:2$（齐音和八度）,$2:3$（五度）,$3:5$（大六度）,$3:4$（四度）,$5:6$（小三度）,$4:5$（大三度），这些音程正是音乐中常见的音程。\n\n<center>\n<img src=\"/images/20241202/Fig2.png\" width=\"75%\" />\n图2: 以中央C音为基准的不和谐度结果\n</center>\n\n## 最自然的系统\n### 概率函数与热力学量\n\n如果已知前一个音， 那么下一个音有可能是什么？对于下一个音的概率的描述，即可视作我们对于音乐系统热力学分布的描述。考虑到一个八度相差的两个音具有相似性，我们只考虑八度内的范围。假设基准音高为$f_0$，记$f=f_0\\cdot2^x\\ (0\\leq x\\leq1)$，那么其概率函数为$p(x)$。\n\n热力学量便可借由概率函数表达，首先是熵。我们借用香农关于信息熵的定义，因此可以得到系统的熵为\n\n$$\n\\begin{align}\n  S=-\\int_{0}^{1}p(x)\\ln p(x)\\text{d}x\n\\end{align}\n$$\n\n内能我们首先定义一个相互作用能的平均值，即$\\overline{U}(x)=\\sum_{n=-\\infty}^{+\\infty}U(f_0,f_0\\cdot2^{x+n})$，那么系统的内能为\n\n$$\n\\begin{align}\n  U=\\frac{1}{2}\\int_{0}^{1}\\int_{0}^{1}p(x)\\overline{U}(x-y)p(y)\\text{d}x\\text{d}y\n\\end{align}\n$$\n\n最后该问题事实上成为了在不同$T$下求解$p(x)$以最小化系统的自由能$F=U-TS$，注意$p(x)$满足归一化约束$\\int_{0}^{1}p(x)\\text{d}x=1$。\n\n### 变分法求解\n\n由于最自然的系统使得$F$有极小值，因此我们可以通过变分法求解。首先我们可以得到自由能的变分\n\n$$\n\\begin{aligned}\n  \\delta F&=\\int_{0}^{1}\\left[\\int_{0}^{1}\\overline{U}(x-y)p(y)\\text{d}y+T(1+\\ln p(x))\\right]\\delta p(x)\\text{d}x\\\\\n  &=\\int_{0}^{1}\\left[\\int_{0}^{1}\\overline{U}(x-y)p(y)\\text{d}y+T\\ln p(x)\\right]\\delta p(x)\\text{d}x\n\\end{aligned}\n$$\n\n上式利用到了约束条件的变分$\\int_{0}^{1}\\delta p(x)\\text{d}x=0$。根据极值条件$\\delta F=0$，可以得到$p(x)$满足的积分方程\n\n$$\n\\begin{align}\n  &\\int_{0}^{1}\\overline{U}(x-y)p(y)\\text{d}y+T\\ln p(x)=\\text{const}\\\\\n  \\implies &p(x)=\\frac{\\exp\\left[-\\frac{1}{T}\\int_{0}^{1}\\overline{U}(x-y)p(y)\\text{d}y\\right]}{\\int_{0}^{1}\\exp\\left[-\\frac{1}{T}\\int_{0}^{1}\\overline{U}(z-y)p(y)\\text{d}y\\right]\\text{d}z}\n\\end{align}\n$$\n\n该方程可以通过迭代法求解，将方程视作$p(x)=\\hat{Q}p(x)$，其中$\\hat{Q}$为一个算符，那么我们可以通过迭代$p(x)=\\hat{Q}^np(x)$来求解。为了减少震荡，可以引入一个松弛参数$\\alpha$，有$p(x)=\\alpha p(x)+(1-\\alpha)\\hat{Q}p(x)=\\bar{Q}p(x)$，其中$\\bar{Q}=\\alpha I+(1-\\alpha)\\hat{Q}$。\n\n计算代码如下（此处取中央C音为基准进行了计算）\n\n```python\nimport numpy as np\nimport matplotlib.pyplot as plt\n\n# 略去不和谐度计算的实现\n\n# 核函数U\ndef U(f, x):\n    res = 0\n    for i in range(-5, 5):\n        res += dissonance_total(f, f * np.float_power(2, x + i), 8) \n    return res\n\n# 预处理U函数\ndef Upre(f):\n    x = np.linspace(0, 2, 2000)\n    y = np.zeros(2000)\n    for i in range(2000):\n        y[i] = U(f, x[i] - 1)\n    return y\n\n# 预处理积分函数\ndef prefun(p, T, f, U1):\n    y = np.zeros(1000)\n    for i in range(1000):\n        for j in range(1000):\n            y[i] += U1[1000+i-j] * p[j] * 0.001\n        y[i] = np.exp(-(y[i] / T))\n    return y\n\n# Q算符\ndef Q(p, T, f, U1):\n    ans = prefun(p, T, f, U1)\n    intans = np.sum(ans) * 0.001\n    y = ans / intans\n    return y\n\n# 绘制p(x)\ndef plot_p(p, label):\n    x = np.linspace(0, 1, 1000)\n    plt.plot(x, p, label=label)\n\n#主函数\nif __name__ == '__main__':\n    f = 261.626\n    T_values = [0.3, 0.6, 10]\n    a = 1 / 3\n    U1 = Upre(f)\n\n    for T in T_values:\n        p = np.ones(1000) / 1000\n        for i in range(50):\n            q = Q(p, T, f, U1)\n            p = a * p + (1 - a) * q\n        plot_p(p, label=f'T={T}')\n\n    plt.xlabel('x')\n    plt.ylabel('p(x)')\n    plt.ylim(0, 1.2)\n    plt.title('p(x) for different T values')\n    plt.legend()\n    plt.show()\n```\n\n计算结果如下图所示，可以发现$p(x)$在不同的$T$下明显有着不同的分布。\n\n<center>\n<img src=\"/images/20241202/Fig3.png\" width=\"75%\" />\n图3: 不同温度下的概率分布\n</center>\n\n## 相变\n### 系统的相\n\n如果$T$极小，意味着系统并不追求复杂性的变化，那么$p(x)$会更加集中在某些音调上；而如果$T$极大，系统会追求更多的变化，因此$p(x)$在不同音调上的概率会更加平均；而$T$还存在一个区间，使得$p(x)$有着波动状的分布。\n\n既然我们已经发现了$p(x)$在不同$T$下的分布存在明显的差异，一个很自然的想法就是系统存在着相变，而该系统存在着三个相，按照温度$T$从高到低依次记为&#8544;，&#8545;，&#8546;相。相变温度记为$T_{c1}, T_{c2}\\ (T_{c1}>T\n_{c2})$。\n\n### 二级相变\n\n系统从&#8544;相到&#8545;相的相变是一个二级相变，这是因为系统的熵在相变点处不连续。我们使用朗道理论来描述这个相变，首先进行傅里叶展开$\\overline{U}(x)=\\sum_{k=0}^{+\\infty}u_k\\cos2\\pi kx, p(x)=\\frac{1}{2}\\sum_{k=0}^{+\\infty}\\left(p_ke^{2\\pi ikx}+p_k^*e^{-2\\pi ikx}\\right)$，并代入计算得到\n\n$$\n\\begin{align}\n  U=\\frac{1}{2}u_0+\\frac{1}{8}\\sum_{k=1}^{+\\infty}d_k|p_k|^2\n\\end{align}\n$$\n$$\n\\begin{align}\n  S=\\sum_{n=2}^{+\\infty}\\frac{(-1)^{n-1}}{n(n-1)2^n}\\int_0^1\\left(\\sum_{k=0}^{+\\infty}\\left(p_ke^{2\\pi ikx}+p_k^*e^{-2\\pi ikx}\\right)\\right)^n\\text{d}x\n\\end{align}\n$$\n\n在$T_{c1}$附近展开，我们可以得到\n\n$$\n\\begin{align}\n  F\\approx\\frac{1}{2}u_0+\\frac{1}{4}\\sum_{k=1}^{+\\infty}\\left(\\frac{u_k}{2}+T\\right)|p_k|^2\n\\end{align}\n$$\n\n假设最高阶项为正值，当二阶项的符号发生变化时，就会发生相变。因此，当$T$从无序阶段减小时，具有最大负值$u_k=u_{k_0}$的项将首先改变符号，单模 $k_0$将具有非零的$p_{k_0}$，因此根据朗道理论我们可以得到\n\n$$\n\\begin{align}\n  T_{c1}=-\\frac{u_{k_0}}{2}\n\\end{align}\n$$\n\n### 一级相变\n\n系统从&#8545;相到&#8546;相的相变是一个一级相变，这是因为系统的熵在相变点处连续。但是内能在相变点处会发生突变。在此采用简单的半定量说明内能突变大小。\n\n在&#8546;相其近似为集中在一个音调上，因此我们取$p(x)=\\delta(x-x_0)$，那么系统的内能为\n\n$$\n\\begin{align}\n  U=\\frac{1}{2}\\overline{U}(0)\n\\end{align}\n$$\n\n而在刚刚过渡至&#8545;相，我们取$p(x)=(1-\\lambda)\\delta(x-x_0)+\\lambda\\delta(x-x_1)$，也即另一个音调略微出现，那么系统的内能为\n\n$$\n\\begin{align}\n  U=\\frac{1}{2}\\overline{U}(0)+\\lambda(1-\\lambda)\\left(\\overline{U}(x_1-x_0)-\\overline{U}(0)\\right)\n\\end{align}\n$$\n\n## 结语\n\nJesse Berzovsky的工作[^1]在后续还提供了更为完整和复杂的对整首乐曲的分析，并且类比XY模型，提出了音乐的“相变”概念。建议阅读原文以获得更多信息。\n\n[^1]: Jesse Berezovsky, The structure of musical harmony as an ordered phase of sound: A statistical mechanics approach to music theory. *Sci. Adv.* **5**, eaav8490(2019).DOI:10.1126/sciadv.aav8490\n\n[^2]: Bernini, A. and Talamucci, F. (2014) Consonance of Complex Tones with Harmonics of Different Intensity. *Open Journal of Acoustics*, **4**, 78-89. doi: 10.4236/oja.2014.42008.","tags":["统计力学","热力学"],"categories":["物理竞赛"]},{"title":"有Bug的物理竞赛","url":"/2024/12/01/有Bug的物理竞赛/","content":"\n## 竞赛规章笑传\n\n物理竞赛的一切都是*打破常规*的😅。大纲就是用来**超出**的，规章就是用来**打破**的。\n\n{% blockquote 全国中学生物理竞赛委员会 https://cpho.pku.edu.cn/info/1033/1046.htm 《关于全国中学生物理竞赛保密工作的规定》 %}\n\n四、竞赛的试题和解答在启用前是绝密的。命题人员、审题人员和涉及命题制卷工作的工作人员不得以任何方式有意或无意地向不属于本工作范围以内的任何人（包括全国竞委会委员、地方竞委会委员、决赛组委会委员以及各级行政机构领导人员）泄露与试题和解答有关的任何信息，不得利用工作之便探听不属于本人工作范围内的其他与试题和解答有关的信息。\n\n{% endblockquote %}\n\n{% blockquote 全国中学生物理竞赛委员会 https://cpho.pku.edu.cn/info/1033/1305.htm 《全国中学生物理竞赛实施细则（2022年6月修订版）》%}\n\n五、竞赛工作中违规或失职行为的定义\n\n1.参赛学生违规行为是指：\n\n&ensp;（2）以不正当的行为提前得到与竞赛题目有关的信息。\n\n2.考试地点工作人员的违规或失职行为是指：\n\n&ensp;（2）提前直接或间接将竞赛题目泄露给参赛学生。\n\n……（其他类似相关条目）\n\n{% endblockquote %}\n\n在如此“严格”的规章制度下，想必竞赛生得到的是公平公正的比赛环境吧🤓☝️\n\n## 泄题事件\n### 36th CPhO决赛承办学校学军中学泄题\n\n36th CPhO决赛学军中学以一己之力获得**7个**集训队名额，而连竞赛强省湖南总共也只有7个名额。随后点燃舆论的是一张QQ空间说说配图。\n\n![张水秀南的QQ空间说说配图](/images/20241201/Fig1.webp)\n\n在这张配图背后的黑板上有着决赛题目的部分内容，而该同学的生日是在决赛之前。\n\n2019年11月2日，全国中学生竞赛委员会和浙江物理学会分别发表声明澄清。\n\n👉现在公告内容已经被官方删除，官网无法查询，~~考虑到可能有人不会用魔法上网~~，我将互联网档案馆找到的原文贴在下面👈\n\n{% blockquote 浙江省物理学会 %}\n\n中国物理学会全国中学生物理竞赛委员会： \n\n近日，网络上有网友质疑第36届全国中学生物理竞赛全国决赛的比赛结果。浙江省物理学会关注到此事，并进行了核实，认为网络上提及的情况不实。 \n\n事件起因是10月31日晚上杭州学军中学一个物竞的参赛同学发了QQ说说，并配了一张在教室里过生日的照片。照片背景的黑板上有与物理决赛第一题相关的讨论内容。有人据此认为学军考生存在舞弊行为，此言论在网络上引起发酵。我们通过调查了解，说明如下： \n\n1.从实际得分情况来看，这一题的实际得分情况学军的考生普遍低，比如发qq说说的这位同学，得了10分（满分40分，全国平均得分为23分），还有其他多位同学得分也低于全国平均分。 \n\n2.30日颁奖结束后，因为对决赛第一题答题不理想，部分物竞同学回到学军西溪校区后，在备考教室黑板上研究讨论这一题，所以黑板上留下了该题解题讨论的部分过程。 \n\n3.讨论后，接着部分同学就给该同学过生日，实际是补过生日。决赛结束前，全体同学们一直在紧张备战决赛，所以一直到30号晚上决赛结束了，同学们才放松一下，回到校园给该同学补过生日。据查实，相关生日照片拍摄的时间为2019年10月30日晚11:16-11:23之间。本次决赛考试时间是10月26日，讲评试卷是10月28日。该同学过生日拍照时间是10月30日晚，而不是所谓的10月24日。此时，全国决赛考试和颁奖典礼都已经结束了，更不是在决赛考试前，因此不存在所谓的泄题情况。 \n\n该事件可能会给全国中学生物理竞赛带来影响，建议全国竞委会在适当场合给予澄清。 \n\n浙江省物理学会 \n\n2019年11月2日\n\n{% endblockquote %}\n\n{% blockquote 全国中学生物理竞赛委员会 《关于学军中学学生发表QQ短文和庆祝生日照片相关情况的说明》%}\n\n经核实，照片中显示的全国物理竞赛决赛试题第一题内容及其他黑板上显示的内容均写于十月三十日晚上。发表短文和照片的学生第一题得分未超过10分（满分40分），该学生在物理决赛中获得二等奖。有关这一事件的详细情况参见浙江省物理学会11月2日发表的情况说明。 \n\n全国中学生物理竞赛委员会 \n\n2019 年11月2日\n\n{% endblockquote %}\n\n笑点解析：可查证的事实与官方发表声明不符😅\n\n更详细的信息可以参见[这篇文章](https://www.zhihu.com/question/353626585/answer/880220243)\n\n后续处理：啊？还有后续处理？不存在的😅\n\n### 37th CPhO决赛承办学校湖南师大附中泄题\n\n37th CPhO决赛中，湖南省以21名国家集训队名额的优异成绩遥遥领先!\n\n当年实验命题学校是湖南师范大学，考生普遍反映实验量大，然而湖南省的考生实验成绩几乎满分，由此可见湖南考生在实验上背诵功底扎实👍\n\n>物竞大佬对湖南物竞生夸口道：“我们掌握了物理竞赛决赛需要的所有知识点。”\n>\n>湖南物竞生说：“那又有什么，我们掌握了这届决赛所有实验仪器的参数。”\n\n面对质疑至今湖南物理学会和全国物理学会都处于装死的状态，没有给出任何回应。不过比较幽默的是他们当机立断，取消掉了第一名发言的环节👈🤣\n\n最著名的事件：28日决赛闭幕式学生起哄喝倒彩，喝倒彩切片戳[这里](https://www.bilibili.com/video/BV1qt4y1j7Fc)，闭幕式完整版戳[这里](https://wx.vzan.com/live/page/1555986747?shauid=m1aW5FGrUp3HJpFjdHprWw**&sharetstamp=1705446602152&v=1705446779560&ver=af01ae96ec174737b9677cdea4d0cc9c)。\n\n2024年我询问了湖南师大附的同学关于当年的事情，根据其回忆，在当时的长沙几所学校都可以花钱直接买到题目答案。他还表明当时进入集训队的学生有的水平本来只能考到大概一百名，最后成绩却“奇迹”的跃进到前五十。\n\n虽然全国物理学会没有针对这一事件做出任何的调查处分，但是这一年的比赛再叠加上疫情的因素，直接促使此后物理竞赛赛制的变化，取消掉实验实操而改为笔试实验的环节。\n\n❤️也是在这一届比赛之后，一些感受到物理竞赛极大不公的学生组织在一起，成立了学生公益组织[CPHOS](https://cphos.cn/)❤️\n\n### 38th CPhO决赛组委会泄题\n\n38th CPhO决赛组委会通过培训机构泄题，导致部分考生提前得知试题。\n\n目前具体细节不详，但是当年一些考生的成绩在最后一题有明显的异常。\n\n### 其他事件\n\n- 35th CPhO辽宁赛区复赛篡改成绩\n- 41th CPhO湖北赛区复赛承办学校黄冈中学泄题\n\n或许还有更多其他事件，但是未曾被揭露出来。\n\n## 东道主效应\n\n物理竞赛常年表现出东道主效应：即举办学校可以取得更好的成绩。\n\n白色合规的理由是包括奖励名额在内，更多更好的机会按照赛制分配给东道主。然而也存在一些介于灰色地带的操作。\n\n例如39th CPhO决赛承办学校华师一附中在查分时除开正常的查分操作，还有教练牵头带学生直接与改卷教授面对面交流。当年决赛的最终答案实际上是由初版答案结合华师一附中学生的解答进行了修改。（**先射箭，再画靶**）\n\n事实上每一届都存在类似操作，无非是影响大小的不同。\n\n物理竞赛作为清华北大选拔的重要途径，但是依旧欠缺公平公正，透明公开的环境。","tags":["杂谈","36届全国中学生物理竞赛","37届全国中学生物理竞赛"],"categories":["物理竞赛"]},{"title":"Test Blog","url":"/2024/11/30/Test Blog/","content":"\n## Test\n\nThis is a test blog.\n\n*This is a test blog.*\n\n**This is a test blog**\n\n## Math Formula\n\nEinstein's mass-energy formula is $E = mc^2$.\n\nEinstein's mass-energy formula is:\n\n$$\nE=mc^2\n$$\n\nThe total energy of a partical is:\n\n$$\n\\begin{aligned}\n    E &= mc^2 \\\\\n    &= \\sqrt{m_0^2c^4+p^2c^2}\n\\end{aligned}\n$$\n\n## Code Block\n\nThis is a C++ code to print `Hello, World!`.\n\n```cpp\n// test.cpp\n#include <iostream>\n\nint main() {\n    std::cout << \"Hello, World!\" << std::endl;\n    return 0;\n}\n```\n\nYou need to compile this code by typing commands in the terminal.\n\n```bash\ng++ -O test test.cpp\n./test\n```\n\n## Image\n\nA image of Reimu.\n\n![](/images/test/test.jpg)"}]